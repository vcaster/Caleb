var winCal;var dtToday;var Cal;var MonthName;var WeekDayName1;var WeekDayName2;var exDateTime;var selDate;var calSpanID="calBorder";var domStyle=null;var cnLeft="0";var cnTop="0";var xpos=0;var ypos=0;var calHeight=0;var CalWidth=208;var CellWidth=30;var TimeMode=24;var d=new Date();var StartYear=d.getFullYear();var EndYear=5;var CalPosOffsetX=-100;var CalPosOffsetY=25;var SpanBorderColor="#33A1DE";var SpanBgColor="#B0C4DE";var MonthYearColor="#33A1DE";var WeekHeadColor="#87CEFF";var SundayColor="#E6E8FA";var SaturdayColor="#E6E8FA";var WeekDayColor="#E6E8FA";var FontColor="blue";var TodayColor="#A4D3EE";var SelDateColor="#60AFFE";var YrSelColor="#F87217";var MthSelColor="#cc0033";var HoverColor="#E0FF38";var DisableColor="#D8D8D8";var CalBgColor="#F0F0F0";var WeekChar=2;var DateSeparator="-";var ShowLongMonth=true;var ShowMonthYear=true;var ThemeBg="";var PrecedeZero=true;var MondayFirstDay=false;var UseImageFiles=true;var DisableBeforeToday=true;var imageFilesPath="images/";var MonthName=["January","February","March","April","May","June","July","August","September","October","November","December"];var WeekDayName1=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var WeekDayName2=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function Calendar(a,b){this.Date=a.getDate();this.Month=a.getMonth();this.Year=a.getFullYear();this.Hours=a.getHours();if(a.getMinutes()<10){this.Minutes="0"+a.getMinutes()}else{this.Minutes=a.getMinutes()}if(a.getSeconds()<10){this.Seconds="0"+a.getSeconds()}else{this.Seconds=a.getSeconds()}this.MyWindow=winCal;this.Ctrl=b;this.Format="ddMMyyyy";this.Separator=DateSeparator;this.ShowTime=false;this.Scroller="DROPDOWN";if(a.getHours()<12){this.AMorPM="AM"}else{this.AMorPM="PM"}this.ShowSeconds=false}Calendar.prototype.GetMonthIndex=function(b){for(var a=0;a<12;a+=1){if(MonthName[a].substring(0,3).toUpperCase()===b.toUpperCase()){return a}}};Calendar.prototype.IncYear=function(){if(Cal.Year<=dtToday.getFullYear()+EndYear){Cal.Year+=1}};Calendar.prototype.DecYear=function(){if(Cal.Year>StartYear){Cal.Year-=1}};Calendar.prototype.IncMonth=function(){if(Cal.Year<=dtToday.getFullYear()+EndYear){Cal.Month+=1;if(Cal.Month>=12){Cal.Month=0;Cal.IncYear()}}};Calendar.prototype.DecMonth=function(){if(Cal.Year>=StartYear){Cal.Month-=1;if(Cal.Month<0){Cal.Month=11;Cal.DecYear()}}};Calendar.prototype.SwitchMth=function(a){Cal.Month=parseInt(a,10)};Calendar.prototype.SwitchYear=function(a){Cal.Year=parseInt(a,10)};Calendar.prototype.SetHour=function(a){var c,b,f=new RegExp("^\\d\\d"),e=new RegExp("\\d");if(TimeMode===24){c=23;b=0}else{if(TimeMode===12){c=12;b=1}else{alert("TimeMode can only be 12 or 24")}}if((f.test(a)||e.test(a))&&(parseInt(a,10)>c)){a=b}else{if((f.test(a)||e.test(a))&&(parseInt(a,10)<b)){a=c}}if(e.test(a)){a="0"+a}if(f.test(a)&&(parseInt(a,10)<=c)&&(parseInt(a,10)>=b)){if((TimeMode===12)&&(Cal.AMorPM==="PM")){if(parseInt(a,10)===12){Cal.Hours=12}else{Cal.Hours=parseInt(a,10)+12}}else{if((TimeMode===12)&&(Cal.AMorPM==="AM")){if(a===12){a-=12}Cal.Hours=parseInt(a,10)}else{if(TimeMode===24){Cal.Hours=parseInt(a,10)}}}}};Calendar.prototype.SetMinute=function(a){var c=59,e=0,f=new RegExp("\\d"),b=new RegExp("^\\d{1}$"),h=new RegExp("^\\d{2}$"),g=0;if((h.test(a)||f.test(a))&&(parseInt(a,10)>c)){a=e}else{if((h.test(a)||f.test(a))&&(parseInt(a,10)<e)){a=c}}g=a+"";if(b.test(a)){g="0"+g}if((h.test(a)||f.test(a))&&(parseInt(a,10)<=59)&&(parseInt(a,10)>=0)){Cal.Minutes=g}};Calendar.prototype.SetSecond=function(b){var f=59,g=0,h=new RegExp("\\d"),e=new RegExp("^\\d{1}$"),c=new RegExp("^\\d{2}$"),a=0;if((c.test(b)||h.test(b))&&(parseInt(b,10)>f)){b=g}else{if((c.test(b)||h.test(b))&&(parseInt(b,10)<g)){b=f}}a=b+"";if(e.test(b)){a="0"+a}if((c.test(b)||h.test(b))&&(parseInt(b,10)<=59)&&(parseInt(b,10)>=0)){Cal.Seconds=a}};Calendar.prototype.SetAmPm=function(a){this.AMorPM=a;if(a==="PM"){this.Hours=parseInt(this.Hours,10)+12;if(this.Hours===24){this.Hours=12}}else{if(a==="AM"){this.Hours-=12}}};Calendar.prototype.getShowHour=function(){var a;if(TimeMode===12){if(parseInt(this.Hours,10)===0){this.AMorPM="AM";a=parseInt(this.Hours,10)+12}else{if(parseInt(this.Hours,10)===12){this.AMorPM="PM";a=12}else{if(this.Hours>12){this.AMorPM="PM";if((this.Hours-12)<10){a="0"+((parseInt(this.Hours,10))-12)}else{a=parseInt(this.Hours,10)-12}}else{this.AMorPM="AM";if(this.Hours<10){a="0"+parseInt(this.Hours,10)}else{a=this.Hours}}}}}else{if(TimeMode===24){if(this.Hours<10){a="0"+parseInt(this.Hours,10)}else{a=this.Hours}}}return a};Calendar.prototype.getShowAMorPM=function(){return this.AMorPM};Calendar.prototype.GetMonthName=function(b){var a=MonthName[this.Month];if(b){return a}else{return a.substr(0,3)}};Calendar.prototype.GetMonDays=function(){var a=[31,28,31,30,31,30,31,31,30,31,30,31];if(Cal.IsLeapYear()){a[1]=29}return a[this.Month]};Calendar.prototype.IsLeapYear=function(){if((this.Year%4)===0){if((this.Year%100===0)&&(this.Year%400)!==0){return false}else{return true}}else{return false}};Calendar.prototype.FormatDate=function(b){var a=this.Month+1;if(PrecedeZero===true){if((b<10)&&String(b).length===1){b="0"+b}if(a<10){a="0"+a}}switch(this.Format.toUpperCase()){case"DDMMYYYY":return(b+DateSeparator+a+DateSeparator+this.Year);case"DDMMMYYYY":return(b+DateSeparator+this.GetMonthName(false)+DateSeparator+this.Year);case"MMDDYYYY":return(a+DateSeparator+b+DateSeparator+this.Year);case"MMMDDYYYY":return(this.GetMonthName(false)+DateSeparator+b+DateSeparator+this.Year);case"YYYYMMDD":return(this.Year+DateSeparator+a+DateSeparator+b);case"YYMMDD":return(String(this.Year).substring(2,4)+DateSeparator+a+DateSeparator+b);case"YYMMMDD":return(String(this.Year).substring(2,4)+DateSeparator+this.GetMonthName(false)+DateSeparator+b);case"YYYYMMMDD":return(this.Year+DateSeparator+this.GetMonthName(false)+DateSeparator+b);default:return(b+DateSeparator+(this.Month+1)+DateSeparator+this.Year)}};function GenCell(e,b,h,c){var a,g,i,f;if(!e){a=""}else{a=e}if(h===undefined){h=CalBgColor}if(c!==undefined){i=c}else{i=true}if(Cal.ShowTime){f=" "+Cal.Hours+":"+Cal.Minutes;if(Cal.ShowSeconds){f+=":"+Cal.Seconds}if(TimeMode===12){f+=" "+Cal.AMorPM}}else{f=""}if(a!==""){if(i===true){if(Cal.ShowTime===true){g="<td id='c"+a+"' class='calTD' style='text-align:center;cursor:pointer;background-color:"+h+"' onmousedown='selectDate(this,"+a+");'>"+a+"</td>"}else{g="<td class='calTD' style='text-align:center;cursor:pointer;background-color:"+h+"' onmouseover='changeBorder(this, 0);' onmouseout=\"changeBorder(this, 1, '"+h+"');\" onClick=\"javascript:callback('"+Cal.Ctrl+"','"+Cal.FormatDate(a)+"');\">"+a+"</td>"}}else{g="<td style='text-align:center;background-color:"+h+"' class='calTD'>"+a+"</td>"}}else{g="<td style='text-align:center;background-color:"+h+"' class='calTD'>&nbsp;</td>"}return g}function RenderCssCal(B){if(typeof B==="undefined"||B!==true){B=false}var p,x,c="",m="",D="",k,v,s,o,A=0,r,a=[],n,y,u=false,f="35px",h,l,q,g,z,b,w,C,t;calHeight=0;D="<span style='cursor:auto;'>";p="<table style='background-color:"+CalBgColor+";width:200px;padding:0;margin:5px auto 5px auto'><tbody>";p+="<tr><td colspan='7'><table border='0' width='200px' cellpadding='0' cellspacing='0'><tr>";if(Cal.Scroller==="DROPDOWN"){p+="<td align='center'><select name='MonthSelector' onChange='javascript:Cal.SwitchMth(this.selectedIndex);RenderCssCal();'>";for(v=0;v<12;v+=1){if(v===Cal.Month){o="Selected"}else{o=""}p+="<option "+o+" value="+v+">"+MonthName[v]+"</option>"}p+="</select></td>";p+="<td align='center'><select name='YearSelector' size='1' onChange='javascript:Cal.SwitchYear(this.value);RenderCssCal();'>";for(v=StartYear;v<=(dtToday.getFullYear()+EndYear);v+=1){if(v===Cal.Year){o='selected="selected"'}else{o=""}p+="<option "+o+" value="+v+">"+v+"</option>\n"}p+="</select></td>\n";calHeight+=30}else{if(Cal.Scroller==="ARROW"){if(UseImageFiles){p+="<td><img onmousedown='javascript:Cal.DecYear();RenderCssCal();' src='"+imageFilesPath+"cal_fastreverse.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td>\n";p+="<td><img onmousedown='javascript:Cal.DecMonth();RenderCssCal();' src='"+imageFilesPath+"cal_reverse.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td>\n";p+="<td width='70%' class='calR' style='color:"+YrSelColor+"'>"+Cal.GetMonthName(ShowLongMonth)+" "+Cal.Year+"</td>";p+="<td><img onmousedown='javascript:Cal.IncMonth();RenderCssCal();' src='"+imageFilesPath+"cal_forward.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td>\n";p+="<td><img onmousedown='javascript:Cal.IncYear();RenderCssCal();' src='"+imageFilesPath+"cal_fastforward.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td>\n";calHeight+=22}else{p+="<td><span id='dec_year' title='reverse year' onmousedown='javascript:Cal.DecYear();RenderCssCal();' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white; color:"+YrSelColor+"'>-</span></td>";p+="<td><span id='dec_month' title='reverse month' onmousedown='javascript:Cal.DecMonth();RenderCssCal();' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'>&lt;</span></td>\n";p+="<td width='70%' class='calR' style='color:"+YrSelColor+"'>"+Cal.GetMonthName(ShowLongMonth)+" "+Cal.Year+"</td>\n";p+="<td><span id='inc_month' title='forward month' onmousedown='javascript:Cal.IncMonth();RenderCssCal();' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'>&gt;</span></td>\n";p+="<td><span id='inc_year' title='forward year' onmousedown='javascript:Cal.IncYear();RenderCssCal();'  onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white; color:"+YrSelColor+"'>+</span></td>\n";calHeight+=22}}}p+="</tr></table></td></tr>";if(ShowMonthYear&&Cal.Scroller==="DROPDOWN"){p+="<tr><td colspan='7' class='calR' style='color:"+MonthYearColor+"'>"+Cal.GetMonthName(ShowLongMonth)+" "+Cal.Year+"</td></tr>";calHeight+=19}p+="<tr><td colspan=\"7\"><table style='border-spacing:1px;border-collapse:separate;'><tr>";if(MondayFirstDay===true){a=WeekDayName2}else{a=WeekDayName1}for(v=0;v<7;v+=1){p+="<td style='background-color:"+WeekHeadColor+";width:"+CellWidth+"px;color:#FFFFFF' class='calTD'>"+a[v].substr(0,WeekChar)+"</td>"}calHeight+=19;p+="</tr>";k=new Date(Cal.Year,Cal.Month);k.setDate(1);r=k.getDay();if(MondayFirstDay===true){r-=1;if(r===-1){r=6}}x="<tr>";calHeight+=19;for(v=0;v<r;v+=1){x=x+GenCell();A=A+1}for(s=1;s<=Cal.GetMonDays();s+=1){if((A%7===0)&&(s>1)){x=x+"<tr>"}A=A+1;if(DisableBeforeToday===true&&((s<dtToday.getDate())&&(Cal.Month===dtToday.getMonth())&&(Cal.Year===dtToday.getFullYear())||(Cal.Month<dtToday.getMonth())&&(Cal.Year===dtToday.getFullYear())||(Cal.Year<dtToday.getFullYear()))){n=GenCell(s,false,DisableColor,false)}else{if(Cal.Year>(dtToday.getFullYear()+EndYear)){n=GenCell(s,false,DisableColor,false)}else{if((s===dtToday.getDate())&&(Cal.Month===dtToday.getMonth())&&(Cal.Year===dtToday.getFullYear())){n=GenCell(s,true,TodayColor)}else{if((s===selDate.getDate())&&(Cal.Month===selDate.getMonth())&&(Cal.Year===selDate.getFullYear())){n=GenCell(s,true,SelDateColor)}else{if(MondayFirstDay===true){if(A%7===0){n=GenCell(s,false,SundayColor)}else{if((A+1)%7===0){n=GenCell(s,false,SaturdayColor)}else{n=GenCell(s,null,WeekDayColor)}}}else{if(A%7===0){n=GenCell(s,false,SaturdayColor)}else{if((A+6)%7===0){n=GenCell(s,false,SundayColor)}else{n=GenCell(s,null,WeekDayColor)}}}}}}}x=x+n;if((A%7===0)&&(s<Cal.GetMonDays())){x=x+"</tr>";calHeight+=19}}if(A%7!==0){while(A%7!==0){x=x+GenCell();A=A+1}}x=x+"</table></td></tr>";if(Cal.ShowTime===true){y=Cal.getShowHour();if(Cal.ShowSeconds===false&&TimeMode===24){u=true;f="10px"}c="<tr><td colspan='7' style=\"text-align:center;\"><table border='0' width='199px' cellpadding='0' cellspacing='0'><tbody><tr><td height='5px' width='"+f+"'>&nbsp;</td>";if(u&&UseImageFiles){c+="<td style='vertical-align:middle;'><table cellspacing='0' cellpadding='0' style='line-height:0pt;width:100%;'><tr><td style='text-align:center;'><img onclick='nextStep(\"Hour\", \"plus\");' onmousedown='startSpin(\"Hour\", \"plus\");' onmouseup='stopSpin();' src='"+imageFilesPath+"cal_plus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td></tr><tr><td style='text-align:center;'><img onclick='nextStep(\"Hour\", \"minus\");' onmousedown='startSpin(\"Hour\", \"minus\");' onmouseup='stopSpin();' src='"+imageFilesPath+"cal_minus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td></tr></table></td>\n"}c+="<td width='22px'><input type='text' name='hour' maxlength=2  style=\"WIDTH:22px\" value="+y+' onkeyup="javascript:Cal.SetHour(this.value)">';c+="</td><td style='font-weight:bold;text-align:center;'>:</td><td width='22px'>";c+="<input type='text' name='minute' maxlength=2  style=\"WIDTH: 22px\" value="+Cal.Minutes+' onkeyup="javascript:Cal.SetMinute(this.value)">';if(Cal.ShowSeconds){c+="</td><td style='font-weight:bold;'>:</td><td width='22px'>";c+="<input type='text' name='second' maxlength=2 size=1 style=\"WIDTH: 22px\" value="+Cal.Seconds+' onkeyup="javascript:Cal.SetSecond(parseInt(this.value,10))">'}if(TimeMode===12){h=(Cal.AMorPM==="AM")?"Selected":"";l=(Cal.AMorPM==="PM")?"Selected":"";c+="</td><td>&nbsp;</td><td>";c+='<select name="ampm" onChange="javascript:Cal.SetAmPm(this.options[this.selectedIndex].value);">\n';c+="<option "+h+' value="AM">AM</option>';c+="<option "+l+' value="PM">PM<option>';c+="</select>"}if(u&&UseImageFiles){c+="</td>\n<td style='vertical-align:middle;'><table cellspacing='0' cellpadding='0' style='line-height:0pt;width:100%'><tr><td style='text-align:center;'><img onclick='nextStep(\"Minute\", \"plus\");' onmousedown='startSpin(\"Minute\", \"plus\");' onmouseup='stopSpin();' src='"+imageFilesPath+"cal_plus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td></tr><tr><td style='text-align:center;'><img onmousedown='startSpin(\"Minute\", \"minus\");' onmouseup='stopSpin();' onclick='nextStep(\"Minute\",\"minus\");' src='"+imageFilesPath+"cal_minus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td></tr></table>"}c+="</td>\n<td align='right' valign='bottom' width='"+f+"px'></td></tr>";c+="<tr><td colspan='7' style=\"text-align:center;\"><input style='width:50px;font-size:10px;' onClick='javascript:closewin(\""+Cal.Ctrl+'");\'  type="button" value="OK">&nbsp;<input style=\'width:50px;font-size:10px;\' onClick=\'javascript: winCal.style.visibility = "hidden"\' type="button" value="Cancel"></td></tr>'}else{c+="\n<tr>\n<td colspan='7' style=\"text-align:right;\">";if(UseImageFiles){m+="<img onmousedown='javascript:closewin(\""+Cal.Ctrl+"\"); stopSpin();' src='"+imageFilesPath+"cal_close.gif' width='16px' height='14px' onmouseover='changeBorder(this,0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'></td>"}else{m+="<span id='close_cal' title='close'onmousedown='javascript:closewin(\""+Cal.Ctrl+"\");stopSpin();' onmouseover='changeBorder(this, 0)'onmouseout='changeBorder(this, 1)' style='border:1px solid white; font-family: Arial;font-size: 10pt;'>x</span></td>"}m+="</tr>"}m+="</tbody></table></td></tr>";calHeight+=31;m+="</tbody></table>\n</span>";q="function callback(id, datum) {";q+=" var CalId = document.getElementById(id);if (datum=== 'undefined') { var d = new Date(); datum = d.getDate() + '/' +(d.getMonth()+1) + '/' + d.getFullYear(); } window.calDatum=datum;CalId.value=datum;";q+=" if(Cal.ShowTime){";q+=" CalId.value+=' '+Cal.getShowHour()+':'+Cal.Minutes;";q+=" if (Cal.ShowSeconds)  CalId.value+=':'+Cal.Seconds;";q+=" if (TimeMode === 12)  CalId.value+=''+Cal.getShowAMorPM();";q+="}if(CalId.onchange===true) CalId.onchange();winCal.style.visibility='hidden';}";if(ypos>calHeight){ypos=ypos-calHeight}if(!winCal){g=document.getElementsByTagName("head")[0];z=document.createElement("script");z.type="text/javascript";z.language="javascript";z.text=q;g.appendChild(z);b=".calTD {font-family: verdana; font-size: 12px; text-align: center; border:0; }\n";b+=".calR {font-family: verdana; font-size: 12px; text-align: center; font-weight: bold;}";w=document.createElement("style");w.type="text/css";w.rel="stylesheet";if(w.styleSheet){w.styleSheet.cssText=b}else{C=document.createTextNode(b);w.appendChild(C)}g.appendChild(w);t=document.createElement("span");t.id=calSpanID;t.style.position="absolute";t.style.left=(xpos+CalPosOffsetX)+"px";t.style.top=(ypos-CalPosOffsetY)+"px";t.style.width=CalWidth+"px";t.style.border="solid 1pt "+SpanBorderColor;t.style.padding="0";t.style.cursor="move";t.style.backgroundColor=SpanBgColor;t.style.zIndex=100;document.body.appendChild(t);winCal=document.getElementById(calSpanID);winCal.style.zIndex="10000021"}else{winCal.style.visibility="visible";winCal.style.Height=calHeight;winCal.style.zIndex="10000020";if(B===true){winCal.style.left=(xpos+CalPosOffsetX)+"px";winCal.style.top=(ypos-CalPosOffsetY)+"px"}}winCal.innerHTML=D+p+x+c+m;return true}function NewCssCal(q,l,n,o,v,k){dtToday=new Date();Cal=new Calendar(dtToday);if(o!==undefined){if(o){Cal.ShowTime=true}else{Cal.ShowTime=false}if(v){v=parseInt(v,10)}if(v===12||v===24){TimeMode=v}else{TimeMode=24}if(k!==undefined){if(k){Cal.ShowSeconds=true}else{Cal.ShowSeconds=false}}else{Cal.ShowSeconds=false}}if(q!==undefined){Cal.Ctrl=q}if(l!==undefined){Cal.Format=l.toUpperCase()}else{Cal.Format="MMDDYYYY"}if(n!==undefined){if(n.toUpperCase()==="ARROW"){Cal.Scroller="ARROW"}else{Cal.Scroller="DROPDOWN"}}exDateTime=document.getElementById(q).value;if(exDateTime){var u=exDateTime.indexOf(DateSeparator,0),t=exDateTime.indexOf(DateSeparator,parseInt(u,10)+1),j,g,e,i,r,p,b,m,s,f,c,h=parseInt(Cal.Format.toUpperCase().lastIndexOf("M"),10)-parseInt(Cal.Format.toUpperCase().indexOf("M"),10)-1,a="";if(Cal.Format.toUpperCase()==="DDMMYYYY"||Cal.Format.toUpperCase()==="DDMMMYYYY"){if(DateSeparator===""){e=exDateTime.substring(2,4+h);i=exDateTime.substring(0,2);r=exDateTime.substring(4+h,8+h)}else{if(exDateTime.indexOf("D*")!==-1){e=exDateTime.substring(8,11);i=exDateTime.substring(0,2);r="20"+exDateTime.substring(11,13)}else{e=exDateTime.substring(u+1,t);i=exDateTime.substring(0,u);r=exDateTime.substring(t+1,t+5)}}}else{if(Cal.Format.toUpperCase()==="MMDDYYYY"||Cal.Format.toUpperCase()==="MMMDDYYYY"){if(DateSeparator===""){e=exDateTime.substring(0,2+h);i=exDateTime.substring(2+h,4+h);r=exDateTime.substring(4+h,8+h)}else{e=exDateTime.substring(0,u);i=exDateTime.substring(u+1,t);r=exDateTime.substring(t+1,t+5)}}else{if(Cal.Format.toUpperCase()==="YYYYMMDD"||Cal.Format.toUpperCase()==="YYYYMMMDD"){if(DateSeparator===""){e=exDateTime.substring(4,6+h);i=exDateTime.substring(6+h,8+h);r=exDateTime.substring(0,4)}else{e=exDateTime.substring(u+1,t);i=exDateTime.substring(t+1,t+3);r=exDateTime.substring(0,u)}}else{if(Cal.Format.toUpperCase()==="YYMMDD"||Cal.Format.toUpperCase()==="YYMMMDD"){if(DateSeparator===""){e=exDateTime.substring(2,4+h);i=exDateTime.substring(4+h,6+h);r=exDateTime.substring(0,2)}else{e=exDateTime.substring(u+1,t);i=exDateTime.substring(t+1,t+3);r=exDateTime.substring(0,u)}}}}}if(isNaN(e)){p=Cal.GetMonthIndex(e)}else{p=parseInt(e,10)-1}if((parseInt(p,10)>=0)&&(parseInt(p,10)<12)){Cal.Month=p}b=/^\d{4}$/;if(b.test(r)){if((parseInt(r,10)>=StartYear)&&(parseInt(r,10)<=(dtToday.getFullYear()+EndYear))){Cal.Year=parseInt(r,10)}}if((parseInt(i,10)<=Cal.GetMonDays())&&(parseInt(i,10)>=1)){Cal.Date=i}if(Cal.ShowTime===true){if(TimeMode===12){a=exDateTime.substring(exDateTime.length-2,exDateTime.length);Cal.AMorPM=a}j=exDateTime.indexOf(":",0);g=exDateTime.indexOf(":",(parseInt(j,10)+1));if(j>0){m=exDateTime.substring(j,j-2);Cal.SetHour(m);s=exDateTime.substring(j+1,j+3);Cal.SetMinute(s);f=exDateTime.substring(g+1,g+3);Cal.SetSecond(f)}else{if(exDateTime.indexOf("D*")!==-1){m=exDateTime.substring(2,4);Cal.SetHour(m);s=exDateTime.substring(4,6);Cal.SetMinute(s)}}}}selDate=new Date(Cal.Year,Cal.Month,Cal.Date);RenderCssCal(true)}function closewin(e){if(Cal.ShowTime===true){var b=dtToday.getFullYear()+EndYear;var a=(Cal.Date<dtToday.getDate())&&(Cal.Month===dtToday.getMonth())&&(Cal.Year===dtToday.getFullYear())||(Cal.Month<dtToday.getMonth())&&(Cal.Year===dtToday.getFullYear())||(Cal.Year<dtToday.getFullYear());if((Cal.Year<=b)&&(Cal.Year>=StartYear)&&(Cal.Month===selDate.getMonth())&&(Cal.Year===selDate.getFullYear())){if(DisableBeforeToday===true){if(a===false){callback(e,Cal.FormatDate(Cal.Date))}}else{callback(e,Cal.FormatDate(Cal.Date))}}}var c=document.getElementById(e);c.focus();winCal.style.visibility="hidden"}function changeBorder(b,a,c){if(a===0){b.style.background=HoverColor;b.style.borderColor="black";b.style.cursor="pointer"}else{if(c){b.style.background=c}else{b.style.background="white"}b.style.borderColor="white";b.style.cursor="auto"}}function selectDate(b,a){Cal.Date=a;selDate=new Date(Cal.Year,Cal.Month,Cal.Date);b.style.background=SelDateColor;RenderCssCal()}function pickIt(c){var g,e,f,a;if(document.addEventListener){g=c.target.id;if(g.indexOf(calSpanID)!==-1){e=document.getElementById(g);cnLeft=c.pageX;cnTop=c.pageY;if(e.offsetLeft){cnLeft=(cnLeft-e.offsetLeft);cnTop=(cnTop-e.offsetTop)}}xpos=(c.pageX);ypos=(c.pageY)}else{g=event.srcElement.id;cnLeft=event.offsetX;cnTop=(event.offsetY);f=document.documentElement;a=document.body;xpos=event.clientX+(f.scrollLeft||a.scrollLeft)-(f.clientLeft||0);ypos=event.clientY+(f.scrollTop||a.scrollTop)-(f.clientTop||0)}if(g.indexOf(calSpanID)!==-1){domStyle=document.getElementById(g).style}if(domStyle){domStyle.zIndex=100;return false}else{domStyle=null;return}}function dragIt(a){if(domStyle){if(document.addEventListener){domStyle.left=(event.clientX-cnLeft+document.body.scrollLeft)+"px";domStyle.top=(event.clientY-cnTop+document.body.scrollTop)+"px"}else{domStyle.left=(a.clientX-cnLeft+document.body.scrollLeft)+"px";domStyle.top=(a.clientY-cnTop+document.body.scrollTop)+"px"}}}function nextStep(a,b){if(a==="Hour"){if(b==="plus"){Cal.SetHour(Cal.Hours+1);RenderCssCal()}else{if(b==="minus"){Cal.SetHour(Cal.Hours-1);RenderCssCal()}}}else{if(a==="Minute"){if(b==="plus"){Cal.SetMinute(parseInt(Cal.Minutes,10)+1);RenderCssCal()}else{if(b==="minus"){Cal.SetMinute(parseInt(Cal.Minutes,10)-1);RenderCssCal()}}}}}function startSpin(a,b){document.thisLoop=setInterval(function(){nextStep(a,b)},125)}function stopSpin(){clearInterval(document.thisLoop)}function dropIt(){stopSpin();if(domStyle){domStyle=null}}document.onmousedown=pickIt;document.onmousemove=dragIt;document.onmouseup=dropIt;